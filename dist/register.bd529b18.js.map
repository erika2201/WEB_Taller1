{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,SCAAC,EAAAD,EAAA,gDCAAD,EAAAC,EAAA,sBAGAE,eAAeC,EAAQC,GACnB,MAAMC,EAASC,EAAAC,IAAIR,EAAAS,GAAI,QAASJ,GAChC,IACI,MAAMK,QAAgBH,EAAAI,OAAOL,GAE7B,OADaI,EAAQE,OAEvB,MAAOC,GACLC,QAAQC,IAAIF,iBFLpB,MAAMG,EAAmBC,SAASC,eAAe,oBAC3CC,EAAgBF,SAASC,eAAe,iBAExCE,GADcH,SAASC,eAAe,eAC3BD,SAASC,eAAe,aACnCG,EAAYJ,SAASC,eAAe,aACpCI,EAAaL,SAASC,eAAe,cAEpB,MAApBF,GACDA,EAAiBO,iBAAiB,UAAUpB,MAAOqB,IACjDA,EAAEC,iBACF,MAKMC,EAAU,MALHV,EAAiBW,KAAKC,eAClBZ,EAAiBa,SAASD,YAC7BZ,EAAiBc,MAAMF,eACpBZ,EAAiBe,SAASH,MAOzCI,SAAS,GAGXlB,QAAQC,IAAI,sBAEZ,MAAMkB,QC1BV9B,eAA4B+B,GAJ5BJ,MAImCA,EAJnCC,SAI0CA,IACtC,IACE,MANNI,KAMcA,SAAejC,EAAAkC,+BAA+BF,EAAKJ,EAAMC,GACjE,OAAOI,EAEP,MAAOX,GACO,uBAAXA,EAAEa,MACHC,MAAM,kDAEM,uBAAXd,EAAEa,MACHC,MAAM,+BAEM,8BAAXd,EAAEa,MACHC,MAAM,kCAEPxB,QAAOC,IAAIS,EAAEa,ODWaE,CAAavC,EAAAkC,KAAMR,SCElDvB,eAAiCM,EAAI+B,EAAQC,GAC3C,UACQlC,EAAAmC,OAAOnC,EAAAC,IAAIC,EAAI,QAAS+B,GAASC,GAEvC,MAAOjB,GACPV,QAAQC,IAAIS,IDNRmB,CAAkB3C,EAAAS,GAAIwB,EAAeW,IAAKlB,GAI/CxB,EAAA2C,mBAAmB7C,EAAAkC,MAAM/B,MAAOgC,IAC/B,GAAGA,EAAK,CACN,MAAMS,EAAMT,EAAKS,IACjB,IAAIE,EAAa,GAEjBA,QAD2B1C,EAAQwC,GAEhCE,EAAWd,QACZe,SAASC,KAAO,uBAEhBD,SAASC,KAAO,sBAQN,MAAjB7B,GACCA,EAAcI,iBAAiB,UAAUC,IACvCA,EAAEC,iBACF,MAAMK,EAAQX,EAAcW,MAAMF,MAC5BG,EAAWZ,EAAcY,SAASH,OCjC5CzB,eAAyB+B,EAAMJ,EAAOC,GACpC,IACE,MAzBNI,KAyBcA,SAAejC,EAAA+C,2BAA2Bf,EAAKJ,EAAMC,GAC7DjB,QAAQC,IAAIoB,GACZ,MAAOX,GACRc,MAAM,kCD8BLY,CAAUlD,EAAAkC,KAAMJ,EAAOC,GACvBjB,QAAQC,IAAI,YAGZb,EAAA2C,mBAAmB7C,EAAAkC,MAAM/B,MAAOgC,IAChC,GAAGA,EAAK,CACN,MAAMS,EAAMT,EAAKS,IACjB,IAAIE,EAAa,GAEjBA,QAD2B1C,EAAQwC,GAEhCE,EAAWd,QACZe,SAASC,KAAO,uBAEhBD,SAASC,KAAO,sBAQ1B1B,EAAWC,iBAAiB,SAASC,IACnCtB,EAAAiD,QAAQnD,EAAAkC,MAAMkB,MAAK,KACjBL,SAASC,KAAO,eAChBlC,QAAQC,IAAI,cACXsC,OAAOxC,IACRC,QAAQC,IAAIF,SAKhBX,EAAA2C,mBAAmB7C,EAAAkC,MAAM/B,MAAOgC,IAC3BA,IACDW,WAAaX,EACVW,YACD1B,EAASkC,MAAMC,QAAU,OACzBlC,EAAUiC,MAAMC,QAAU,QAE1BzC,QAAQC,IAAI","sources":["src/scripts/login.js","src/functions/auth.js","src/scripts/getUser.js"],"sourcesContent":["import { db, auth } from \"./app\";\r\nimport { loginUser, registerUser, addUserToDatabase, onAuthStateChanged } from \"../functions/auth\";\r\nimport { getUser } from \"./getUser\";\r\nimport { signOut } from \"firebase/auth\";\r\n\r\nconst registerUserForm = document.getElementById(\"registerUserForm\");\r\nconst loginUserForm = document.getElementById(\"loginUserForm\");\r\nconst profileIcon = document.getElementById(\"profileIcon\");\r\nconst divLogin = document.getElementById(\"loginDiv\");\r\nconst divLogout = document.getElementById(\"logoutDiv\");\r\nconst logoutLink = document.getElementById(\"logoutLink\");\r\n\r\nif(registerUserForm != null){\r\n  registerUserForm.addEventListener(\"submit\", async (e) =>{\r\n    e.preventDefault();\r\n    const name = registerUserForm.name.value;\r\n    const lastname = registerUserForm.lastname.value;\r\n    const email = registerUserForm.email.value;\r\n    const password = registerUserForm.password.value;\r\n    \r\n    const newUser = {\r\n      name,\r\n      lastname,\r\n      email,\r\n      password,\r\n      isAdmin: false,\r\n    };\r\n\r\n    console.log(\"Usuario registrado\");\r\n    \r\n    const userRegistered = await registerUser(auth, newUser);\r\n    await addUserToDatabase(db, userRegistered.uid, newUser);\r\n\r\n\r\n     //Change according to admin status\r\n     onAuthStateChanged(auth, async (user) =>{\r\n      if(user){\r\n        const uid = user.uid;\r\n        let userLogged = [];\r\n        const firebaseUser = await getUser(uid);\r\n        userLogged = firebaseUser;\r\n        if(userLogged.isAdmin){\r\n          location.href = \"./createProduct.html\";\r\n        } else{\r\n          location.href = \"./index.html\";\r\n        }\r\n      }\r\n    });\r\n\r\n  });\r\n  }\r\n\r\nif(loginUserForm != null){\r\n    loginUserForm.addEventListener(\"submit\", e =>{\r\n      e.preventDefault();\r\n      const email = loginUserForm.email.value;\r\n      const password = loginUserForm.password.value;\r\n    \r\n      loginUser(auth, email, password);\r\n      console.log(\"Entraste\");\r\n\r\n       //Change according to admin status\r\n      onAuthStateChanged(auth, async (user) =>{\r\n      if(user){\r\n        const uid = user.uid;\r\n        let userLogged = [];\r\n        const firebaseUser = await getUser(uid);\r\n        userLogged = firebaseUser;\r\n        if(userLogged.isAdmin){\r\n          location.href = \"./createProduct.html\";\r\n        } else{\r\n          location.href = \"./index.html\";\r\n        }\r\n      }\r\n    });\r\n\r\n    });\r\n  }\r\n  \r\nlogoutLink.addEventListener(\"click\", e =>{\r\n  signOut(auth).then(() => {\r\n    location.href = \"./index.html\"\r\n    console.log(\"Salimos\");\r\n  }).catch((error) => {\r\n    console.log(error);\r\n  });\r\n});\r\n\r\n\r\nonAuthStateChanged(auth, async (user) =>{\r\n  if(user){\r\n    userLogged = user;\r\n    if(userLogged){\r\n      divLogin.style.display = \"none\";\r\n      divLogout.style.display = \"flex\";\r\n    } else{\r\n      console.log(\"NO LOG\");\r\n    }\r\n  }\r\n});\r\n\r\n\r\n","import { createUserWithEmailAndPassword, signInWithEmailAndPassword} from \"firebase/auth\";\r\nimport { doc, setDoc } from \"firebase/firestore\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\n\r\nasync function registerUser(auth, {email, password}){\r\n    try {\r\n      const { user } = await createUserWithEmailAndPassword(auth,email,password);\r\n      return user;\r\n\r\n    } catch (e) {\r\n      if(e.code === \"auth/weak-password\"){\r\n        alert(\"Tu contrase침a debe tener al menos 6 caracteres\");\r\n      }\r\n      if(e.code === \"auth/missing-email\"){\r\n        alert(\"Te falta ingresar un correo\");\r\n      }\r\n      if(e.code === \"auth/email-already-in-use\"){\r\n        alert(\"Este correo ya est치 registrado\");\r\n      }\r\n      console.log(e.code);\r\n    }\r\n  }\r\n\r\n  async function loginUser(auth, email, password){\r\n    try {\r\n      const { user } = await signInWithEmailAndPassword(auth,email,password);\r\n      console.log(user);\r\n    } catch (e) {\r\n     alert(\"Usuario o contrase침a inv치lido\");\r\n    }\r\n  }\r\n  \r\n  async function addUserToDatabase(db, userId, userInfo){\r\n    try {\r\n      await setDoc(doc(db, \"users\", userId), userInfo)\r\n      \r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n\r\n  export {\r\n      registerUser,\r\n      loginUser,\r\n      addUserToDatabase,\r\n      onAuthStateChanged\r\n  }","import { db } from \"./app\";\r\nimport { doc, getDoc } from \"firebase/firestore\";\r\n\r\nasync function getUser(id){\r\n    const docRef = doc(db, \"users\", id);\r\n    try {\r\n        const docSnap = await getDoc(docRef);\r\n        const data = docSnap.data();\r\n        return data;\r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n    }\r\n\r\n\r\nexport {\r\n    getUser\r\n}"],"names":["$li1Mx","parcelRequire","$1tHc5","async","$e39277cba762e7bf$export$7cbf767827cd68ba","id","docRef","$etBjH","doc","db","docSnap","getDoc","data","error","console","log","$3f9d32fa80182a14$var$registerUserForm","document","getElementById","$3f9d32fa80182a14$var$loginUserForm","$3f9d32fa80182a14$var$divLogin","$3f9d32fa80182a14$var$divLogout","$3f9d32fa80182a14$var$logoutLink","addEventListener","e","preventDefault","newUser","name","value","lastname","email","password","isAdmin","userRegistered","auth","user","createUserWithEmailAndPassword","code","alert","$c364daf73431f47d$export$16015adca85344a","userId","userInfo","setDoc","$c364daf73431f47d$export$9f9c8eae0fddfad1","uid","onAuthStateChanged","userLogged","location","href","signInWithEmailAndPassword","$c364daf73431f47d$export$692b4a7cc7a486ce","signOut","then","catch","style","display"],"version":3,"file":"register.bd529b18.js.map"}