{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,yBCAAD,EAAAC,EAAA,sCDMA,MAAMC,EAAqBC,SAASC,eAAe,eAC7CC,EAAuBF,SAASC,eAAe,iBAErD,IAAIE,EACAC,EAAO,GAUXC,eAAeC,IACX,MAAMC,EATV,SAAkBC,GACd,MAAMC,EAAMC,OAAOC,SAASC,OAG5B,OAFqB,IAAIC,gBAAgBJ,GACVK,IAAIN,GAMjBO,CAAS,OAa/B,SAAuBC,GACnBd,EAAqBe,UAAY,mBAGjCD,EAAAE,MAAA,mDAOKnB,EACGkB,UAAA,uCAGyBD,EAAAG,sDACGH,EAAcI,sDExCtD,SAAwBC,GACpB,OAAO,IAAIC,KAAKC,aAAa,QAAS,CAClCC,MAAO,WACPC,SAAU,MACVC,sBAAuB,IACxBC,OAAON,GFoC0BO,CAAqBZ,EAAAK,kFAEjDL,EAAAE,MAAAW,OAAgB,YAkBcC,SACnCC,EAAA/B,SAAAC,eAAA,WAEH+B,EAAAhC,SAAAiC,cAAA,OAEAD,EAAME,UAAa,mBAEnBJ,EAAAK,SAAcjB,IACVc,EAAKf,WAAc,aACfC,oCAGXhB,EAAAkC,YAAAJ,GAEDhC,SAA+BqC,cAAA,qBAC/BC,iBAAA,SAAAC,IACY,QAADA,EAACC,OAAAC,SAAAV,EAAAW,aAAA,MAAAH,EAAAC,OAAAG,eAlCgBC,CAAA5B,EAAAE,OAEhBlB,SAAyBqC,cAAA,qBACxBC,iBAAA,SAAAjC,MAAAkC,IAEDM,QAAGC,IAAA,UAKd1C,EAAA2C,KAAA/B,GE/DDX,eAAgC2C,GAC5BC,aAAaC,QAAQ,OAAQC,KAAKC,UAAUJ,IFiE5CK,CAAwCjD,GAClCD,SAAwCmD,EAAAC,mBAAA1D,EAAA2D,GAAArD,EAAAsD,IAAArD,MArC9CsD,CALgB,UCtBpBrD,eAA0BsD,GACtB,MAAMC,EAASC,EAAAC,IAAIjE,EAAA2D,GAAI,WAAYG,GACnC,IAGI,aAFsBE,EAAAE,OAAOH,IACRI,OAEvB,MAAOC,GACLpB,QAAQC,IAAImB,IDaGC,CAAW3D,GAI1BoD,GAAIpD,yBAgEQV,EAAAsE,MAAA9D,MAAA+D,IACfA,GAIDjE,EAAciE,EACfvB,QAAAC,IAAAsB,2DE7FH,WACI,MAAMC,EAASpB,aAAaqB,QAAQ,QACpC,OAAOD,EAASlB,KAAKoB,MAAMF,GAAU","sources":["src/scripts/product.js","src/scripts/getProduct.js","src/utils/index.js"],"sourcesContent":["import { db, auth } from \"./app\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { getProduct } from \"./getProduct\";\r\nimport { createFirebaseCart, getFirebaseCart } from \"../functions/cart.js\";\r\nimport { getMyLocalCart, addProductToCart, currencyFormat } from \"../utils\";\r\n\r\nconst productInfoSection = document.getElementById(\"productInfo\");\r\nconst productAssetsSection = document.getElementById(\"productAssets\");\r\n\r\nlet userLogged = undefined;\r\nlet cart = [];\r\n\r\nfunction getParam(param){\r\n    const url = window.location.search;\r\n    const searchParams = new URLSearchParams(url);\r\n    const productId = searchParams.get(param);\r\n    return productId;\r\n}\r\n\r\n//Get database\r\nasync function loadProduct(){\r\n    const productId = getParam(\"id\");\r\n\r\n    const data = await getProduct(productId);\r\n\r\n    const product = {\r\n        ...data,\r\n        id: productId,\r\n    }\r\n\r\n    renderProduct(product);\r\n\r\n}\r\n\r\nfunction renderProduct(product){\r\n    productAssetsSection.innerHTML = `\r\n    <img src=\"${product.image[0]}\" class=\"product__mainImg\" id=\"mainImg\"></img>`;\r\n\r\n    productInfoSection.innerHTML = `\r\n        <h1 class=\"product__name\">${product.name}</h1>\r\n        <p class=\"product__description\">${product.description}</p>\r\n        <p class=\"product__price\">${currencyFormat(product.price)}</p>\r\n        <button class=\"product__addCart\">Añadir al carrito</button>`;\r\n    \r\n\r\n        if(product.image.length > 1){\r\n            createGallery(product.image);\r\n        }\r\n\r\n        //Add product with the button\r\n        const productCartBtn = document.querySelector(\".product__addCart\");\r\n        productCartBtn.addEventListener(\"click\", async (e) =>{\r\n            console.log(\"añadir\");\r\n            //1.Save on cart\r\n            cart.push(product);\r\n            //2. Save on localStorage\r\n             addProductToCart(cart);\r\n\r\n            if(userLogged){\r\n                await createFirebaseCart(db, userLogged.uid, cart);\r\n            }\r\n        });\r\n\r\n}\r\n\r\nfunction createGallery(image){\r\n    const mainImg = document.getElementById(\"mainImg\");\r\n    const gallery = document.createElement(\"div\");\r\n    gallery.className = \"product__gallery\";\r\n\r\n    image.forEach(image => {\r\n        gallery.innerHTML += `<img src=\"${image}\" class=\"product__img\"></img>`\r\n    });\r\n\r\n    productAssetsSection.appendChild(gallery);\r\n\r\n    const galleryImages = document.querySelector(\".product__gallery\");\r\n\r\n    galleryImages.addEventListener(\"click\", e => {\r\n        if(e.target.tagName === \"IMG\"){\r\n            mainImg.setAttribute(\"src\",e.target.currentSrc);\r\n        }\r\n    })\r\n}\r\n\r\n//Know if there is a userlogged\r\nonAuthStateChanged(auth, async (user) =>{\r\n    if(user){\r\n        userLogged = user;\r\n        console.log(user);\r\n        cart = await getFirebaseCart(db, userLogged.uid);\r\n        console.log(cart);\r\n    } else {\r\n        cart = getMyLocalCart();\r\n    }\r\n\r\n    loadProduct();\r\n});\r\n","import { db } from \"./app\";\r\nimport { doc, getDoc } from \"firebase/firestore\";\r\n\r\nasync function getProduct(id){\r\n    const docRef = doc(db, \"products\", id);\r\n    try {\r\n        const docSnap = await getDoc(docRef);\r\n        const data = docSnap.data();\r\n        return data;\r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n    }\r\n\r\n\r\nexport {\r\n    getProduct\r\n}","async function addProductToCart(cart){\r\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\r\n};\r\n\r\nfunction getMyLocalCart(){\r\n    const myCart = localStorage.getItem(\"cart\");\r\n    return myCart ? JSON.parse(myCart) : [];\r\n}\r\n\r\n//Change to money format\r\nfunction currencyFormat(price) {\r\n    return new Intl.NumberFormat(\"es-CO\", {\r\n        style: 'currency',\r\n        currency: 'COP',\r\n        minimumFractionDigits: 0\r\n    }).format(price);\r\n}\r\n\r\n\r\nexport {\r\n    addProductToCart,\r\n    getMyLocalCart,\r\n    currencyFormat\r\n}\r\n"],"names":["$li1Mx","parcelRequire","$63445bb05f51f6f7$var$productInfoSection","document","getElementById","$63445bb05f51f6f7$var$productAssetsSection","$63445bb05f51f6f7$var$userLogged","$63445bb05f51f6f7$var$cart","async","$63445bb05f51f6f7$var$loadProduct","productId","param","url","window","location","search","URLSearchParams","get","$63445bb05f51f6f7$var$getParam","product","innerHTML","image","name","description","price","Intl","NumberFormat","style","currency","minimumFractionDigits","format","$1eef38cfda4b0c52$export$4670d0ed237a9270","length","image1","mainImg","gallery","createElement","className","forEach","appendChild","querySelector","addEventListener","e","target","tagName","setAttribute","currentSrc","$63445bb05f51f6f7$var$createGallery","console","log","push","cart","localStorage","setItem","JSON","stringify","$1eef38cfda4b0c52$export$1bdbccb25be1b1c","$6naOk","createFirebaseCart","db","uid","$63445bb05f51f6f7$var$renderProduct","id","docRef","$etBjH","doc","getDoc","data","error","$0b9b63970497f0b1$export$e2005c9600188ac7","auth","user","myCart","getItem","parse"],"version":3,"file":"product.ba9d6a8c.js.map"}